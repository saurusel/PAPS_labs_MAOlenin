<?plantuml 1.2026.2beta3?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3418px" preserveAspectRatio="none" style="width:2565px;height:3418px;background:#FFFFFF;" version="1.1" viewBox="0 0 2565 3418" width="2565px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="294.1328" style="stroke:#000000;stroke-width:1.5;" width="2414.4619" x="10" y="1626.0703"/><rect fill="none" height="410.6641" style="stroke:#000000;stroke-width:1.5;" width="2414.4619" x="10" y="2050.7344"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="Buyer" id="part1-lifeline"><g><title>Buyer</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="39.5659" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="43" x2="43" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="WebApp" id="part2-lifeline"><g><title>Web App</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="229.7031" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="233.1313" x2="233.1313" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="ApiClient" id="part3-lifeline"><g><title>API Client</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="408.7065" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="412.1421" x2="412.1421" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="Routers" id="part4-lifeline"><g><title>Backend API .routers.</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="587.71" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="591.3696" x2="591.3696" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="Catalog" id="part5-lifeline"><g><title>Catalog module</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="779.3906" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="783.0503" x2="783.0503" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="Orders" id="part6-lifeline"><g><title>Orders module</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="946.8516" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="950.731" x2="950.731" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part7" data-qualified-name="Inventory" id="part7-lifeline"><g><title>Inventory module</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="1177.7471" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1180.8545" x2="1180.8545" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part8" data-qualified-name="Ledger" id="part8-lifeline"><g><title>Ledger module</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="1352.3755" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1355.6396" x2="1355.6396" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part9" data-qualified-name="Persistence" id="part9-lifeline"><g><title>Persistence Layer .SQLAlchemy.</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="2026.2739" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2029.418" x2="2029.418" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part10" data-qualified-name="DB" id="part10-lifeline"><g><title>PostgreSQL</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="2367.0854" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2370.709" x2="2370.709" y1="81.2969" y2="3337.25"/></g></g><g class="participant-lifeline" data-entity-uid="part11" data-qualified-name="Fulfill" id="part11-lifeline"><g><title>Fulfillment Admin</title><rect fill="#000000" fill-opacity="0.00000" height="3255.9531" width="8" x="2485.1323" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="2488.4619" x2="2488.4619" y1="81.2969" y2="3337.25"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="Buyer" id="part1-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.1318" x="20" y="77.9951">Buyer</text><ellipse cx="43.5659" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43.5659,21.5 L43.5659,48.5 M30.5659,29.5 L56.5659,29.5 M43.5659,48.5 L30.5659,63.5 M43.5659,48.5 L56.5659,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="Buyer" id="part1-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.1318" x="20" y="3349.2451">Buyer</text><ellipse cx="43.5659" cy="3361.0469" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43.5659,3369.0469 L43.5659,3396.0469 M30.5659,3377.0469 L56.5659,3377.0469 M43.5659,3396.0469 L30.5659,3411.0469 M43.5659,3396.0469 L56.5659,3411.0469" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="WebApp" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.1436" x="195.1313" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.1436" x="202.1313" y="69.9951">Web App</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="WebApp" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.1436" x="195.1313" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.1436" x="202.1313" y="3356.2451">Web App</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="ApiClient" id="part3-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81.1289" x="372.1421" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.1289" x="379.1421" y="69.9951">API Client</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="ApiClient" id="part3-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81.1289" x="372.1421" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.1289" x="379.1421" y="3356.2451">API Client</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="Routers" id="part4-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166.6807" x="508.3696" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.6807" x="515.3696" y="69.9951">Backend API (routers)</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="Routers" id="part4-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166.6807" x="508.3696" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152.6807" x="515.3696" y="3356.2451">Backend API (routers)</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="Catalog" id="part5-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124.6807" x="721.0503" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.6807" x="728.0503" y="69.9951">Catalog module</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="Catalog" id="part5-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="124.6807" x="721.0503" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110.6807" x="728.0503" y="3356.2451">Catalog module</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="Orders" id="part6-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118.2412" x="891.731" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.2412" x="898.731" y="69.9951">Orders module</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="Orders" id="part6-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118.2412" x="891.731" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104.2412" x="898.731" y="3356.2451">Orders module</text></g><g class="participant participant-head" data-entity-uid="part7" data-qualified-name="Inventory" id="part7-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.7852" x="1112.8545" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.7852" x="1119.8545" y="69.9951">Inventory module</text></g><g class="participant participant-tail" data-entity-uid="part7" data-qualified-name="Inventory" id="part7-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.7852" x="1112.8545" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.7852" x="1119.8545" y="3356.2451">Inventory module</text></g><g class="participant participant-head" data-entity-uid="part8" data-qualified-name="Ledger" id="part8-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.4717" x="1296.6396" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.4717" x="1303.6396" y="69.9951">Ledger module</text></g><g class="participant participant-tail" data-entity-uid="part8" data-qualified-name="Ledger" id="part8-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.4717" x="1296.6396" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105.4717" x="1303.6396" y="3356.2451">Ledger module</text></g><g class="participant participant-head" data-entity-uid="part9" data-qualified-name="Persistence" id="part9-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="241.7119" x="1909.418" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="227.7119" x="1916.418" y="69.9951">Persistence Layer (SQLAlchemy)</text></g><g class="participant participant-tail" data-entity-uid="part9" data-qualified-name="Persistence" id="part9-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="241.7119" x="1909.418" y="3336.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="227.7119" x="1916.418" y="3356.2451">Persistence Layer (SQLAlchemy)</text></g><g class="participant participant-head" data-entity-uid="part10" data-qualified-name="DB" id="part10-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="2327.709" y="77.9951">PostgreSQL</text><path d="M2353.0854,29 C2353.0854,19 2371.0854,19 2371.0854,19 C2371.0854,19 2389.0854,19 2389.0854,29 L2389.0854,55 C2389.0854,65 2371.0854,65 2371.0854,65 C2371.0854,65 2353.0854,65 2353.0854,55 L2353.0854,29" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M2353.0854,29 C2353.0854,39 2371.0854,39 2371.0854,39 C2371.0854,39 2389.0854,39 2389.0854,29" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part10" data-qualified-name="DB" id="part10-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.7529" x="2327.709" y="3349.2451">PostgreSQL</text><path d="M2353.0854,3362.5469 C2353.0854,3352.5469 2371.0854,3352.5469 2371.0854,3352.5469 C2371.0854,3352.5469 2389.0854,3352.5469 2389.0854,3362.5469 L2389.0854,3388.5469 C2389.0854,3398.5469 2371.0854,3398.5469 2371.0854,3398.5469 C2371.0854,3398.5469 2353.0854,3398.5469 2353.0854,3388.5469 L2353.0854,3362.5469" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M2353.0854,3362.5469 C2353.0854,3372.5469 2371.0854,3372.5469 2371.0854,3372.5469 C2371.0854,3372.5469 2389.0854,3372.5469 2389.0854,3362.5469" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-entity-uid="part11" data-qualified-name="Fulfill" id="part11-head"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.3408" x="2424.4619" y="77.9951">Fulfillment Admin</text><ellipse cx="2489.1323" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M2489.1323,21.5 L2489.1323,48.5 M2476.1323,29.5 L2502.1323,29.5 M2489.1323,48.5 L2476.1323,63.5 M2489.1323,48.5 L2502.1323,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-entity-uid="part11" data-qualified-name="Fulfill" id="part11-tail"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.3408" x="2424.4619" y="3349.2451">Fulfillment Admin</text><ellipse cx="2489.1323" cy="3361.0469" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M2489.1323,3369.0469 L2489.1323,3396.0469 M2476.1323,3377.0469 L2502.1323,3377.0469 M2489.1323,3396.0469 L2476.1323,3411.0469 M2489.1323,3396.0469 L2502.1323,3411.0469" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2558.8027" x="0" y="111.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="111.8633" y2="111.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="114.8633" y2="114.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="201.9541" x="1178.4243" y="101.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183.4282" x="1184.4243" y="117.3638">Browse catalog / product</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#181818" points="221.7031,151.5625,231.7031,155.5625,221.7031,159.5625,225.7031,155.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.5659" x2="227.7031" y1="155.5625" y2="155.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.8486" x="50.5659" y="150.4966">Open catalog</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg2"><polygon fill="#181818" points="400.7065,180.6953,410.7065,184.6953,400.7065,188.6953,404.7065,184.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="233.7031" x2="406.7065" y1="184.6953" y2="184.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7998" x="240.7031" y="179.6294">GET /products</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg3"><polygon fill="#181818" points="579.71,209.8281,589.71,213.8281,579.71,217.8281,583.71,213.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="412.7065" x2="585.71" y1="213.8281" y2="213.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7998" x="419.7065" y="208.7622">GET /products</text></g><g class="message" data-entity-1="part4" data-entity-2="part5" id="msg4"><polygon fill="#181818" points="771.3906,238.9609,781.3906,242.9609,771.3906,246.9609,775.3906,242.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="591.71" x2="777.3906" y1="242.9609" y2="242.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.8838" x="598.71" y="237.895">listProducts()</text></g><g class="message" data-entity-1="part5" data-entity-2="part9" id="msg5"><polygon fill="#181818" points="2018.2739,268.0938,2028.2739,272.0938,2018.2739,276.0938,2022.2739,272.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="783.3906" x2="2024.2739" y1="272.0938" y2="272.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.7188" x="790.3906" y="267.0278">query products</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg6"><polygon fill="#181818" points="2359.0854,297.2266,2369.0854,301.2266,2359.0854,305.2266,2363.0854,301.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="301.2266" y2="301.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5288" x="2037.2739" y="296.1606">SELECT products...</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg7"><polygon fill="#181818" points="2041.2739,326.3594,2031.2739,330.3594,2041.2739,334.3594,2037.2739,330.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="330.3594" y2="330.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.7036" x="2047.2739" y="325.2935">rows</text></g><g class="message" data-entity-1="part9" data-entity-2="part5" id="msg8"><polygon fill="#181818" points="794.3906,355.4922,784.3906,359.4922,794.3906,363.4922,790.3906,359.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="788.3906" x2="2029.2739" y1="359.4922" y2="359.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.0591" x="800.3906" y="354.4263">products</text></g><g class="message" data-entity-1="part5" data-entity-2="part4" id="msg9"><polygon fill="#181818" points="602.71,384.625,592.71,388.625,602.71,392.625,598.71,388.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="782.3906" y1="388.625" y2="388.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.0591" x="608.71" y="383.5591">products</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg10"><polygon fill="#181818" points="423.7065,413.7578,413.7065,417.7578,423.7065,421.7578,419.7065,417.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="417.7578" y2="417.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.0044" x="429.7065" y="412.6919">200 products</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg11"><polygon fill="#181818" points="244.7031,442.8906,234.7031,446.8906,244.7031,450.8906,240.7031,446.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="446.8906" y2="446.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.0591" x="250.7031" y="441.8247">products</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg12"><polygon fill="#181818" points="54.5659,472.0234,44.5659,476.0234,54.5659,480.0234,50.5659,476.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.5659" x2="232.7031" y1="476.0234" y2="476.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.2041" x="60.5659" y="470.9575">Show catalog</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg13"><polygon fill="#181818" points="221.7031,501.1563,231.7031,505.1563,221.7031,509.1563,225.7031,505.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.5659" x2="227.7031" y1="505.1563" y2="505.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.9829" x="50.5659" y="500.0903">Open product card</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg14"><polygon fill="#181818" points="400.7065,530.2891,410.7065,534.2891,400.7065,538.2891,404.7065,534.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="233.7031" x2="406.7065" y1="534.2891" y2="534.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5854" x="240.7031" y="529.2231">GET /products/{id}</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg15"><polygon fill="#181818" points="579.71,559.4219,589.71,563.4219,579.71,567.4219,583.71,563.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="412.7065" x2="585.71" y1="563.4219" y2="563.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5854" x="419.7065" y="558.356">GET /products/{id}</text></g><g class="message" data-entity-1="part4" data-entity-2="part5" id="msg16"><polygon fill="#181818" points="771.3906,588.5547,781.3906,592.5547,771.3906,596.5547,775.3906,592.5547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="591.71" x2="777.3906" y1="592.5547" y2="592.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.228" x="598.71" y="587.4888">getProduct(id)</text></g><g class="message" data-entity-1="part5" data-entity-2="part9" id="msg17"><polygon fill="#181818" points="2018.2739,617.6875,2028.2739,621.6875,2018.2739,625.6875,2022.2739,621.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="783.3906" x2="2024.2739" y1="621.6875" y2="621.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.7222" x="790.3906" y="616.6216">query product+media+stock</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg18"><polygon fill="#181818" points="2359.0854,646.8203,2369.0854,650.8203,2359.0854,654.8203,2363.0854,650.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="650.8203" y2="650.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.5068" x="2037.2739" y="645.7544">SELECT product/media/stock...</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg19"><polygon fill="#181818" points="2041.2739,675.9531,2031.2739,679.9531,2041.2739,683.9531,2037.2739,679.9531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="679.9531" y2="679.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.7036" x="2047.2739" y="674.8872">rows</text></g><g class="message" data-entity-1="part9" data-entity-2="part5" id="msg20"><polygon fill="#181818" points="794.3906,705.0859,784.3906,709.0859,794.3906,713.0859,790.3906,709.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="788.3906" x2="2029.2739" y1="709.0859" y2="709.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.7285" x="800.3906" y="704.02">product details</text></g><g class="message" data-entity-1="part5" data-entity-2="part4" id="msg21"><polygon fill="#181818" points="602.71,734.2188,592.71,738.2188,602.71,742.2188,598.71,738.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="782.3906" y1="738.2188" y2="738.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.7285" x="608.71" y="733.1528">product details</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg22"><polygon fill="#181818" points="423.7065,763.3516,413.7065,767.3516,423.7065,771.3516,419.7065,767.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="767.3516" y2="767.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.2314" x="429.7065" y="762.2856">200 product</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg23"><polygon fill="#181818" points="244.7031,792.4844,234.7031,796.4844,244.7031,800.4844,240.7031,796.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="796.4844" y2="796.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.2861" x="250.7031" y="791.4185">product</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg24"><polygon fill="#181818" points="54.5659,821.6172,44.5659,825.6172,54.5659,829.6172,50.5659,825.6172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.5659" x2="232.7031" y1="825.6172" y2="825.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.3384" x="60.5659" y="820.5513">Show product card</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2558.8027" x="0" y="854.1836"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="854.1836" y2="854.1836"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="857.1836" y2="857.1836"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="100.4995" x="1229.1516" y="843.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.9736" x="1235.1516" y="859.6841">Add to cart</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg25"><polygon fill="#181818" points="221.7031,893.8828,231.7031,897.8828,221.7031,901.8828,225.7031,897.8828" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.5659" x2="227.7031" y1="897.8828" y2="897.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.1372" x="50.5659" y="892.8169">Add to cart (product, qty)</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg26"><polygon fill="#181818" points="400.7065,923.0156,410.7065,927.0156,400.7065,931.0156,404.7065,927.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="233.7031" x2="406.7065" y1="927.0156" y2="927.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.856" x="240.7031" y="921.9497">POST /cart/items</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg27"><polygon fill="#181818" points="579.71,952.1484,589.71,956.1484,579.71,960.1484,583.71,956.1484" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="412.7065" x2="585.71" y1="956.1484" y2="956.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.856" x="419.7065" y="951.0825">POST /cart/items</text></g><g class="message" data-entity-1="part4" data-entity-2="part6" id="msg28"><polygon fill="#181818" points="938.8516,981.2813,948.8516,985.2813,938.8516,989.2813,942.8516,985.2813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="591.71" x2="944.8516" y1="985.2813" y2="985.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.2065" x="598.71" y="980.2153">addToCart(user, product, qty)</text></g><g class="message" data-entity-1="part6" data-entity-2="part9" id="msg29"><polygon fill="#181818" points="2018.2739,1010.4141,2028.2739,1014.4141,2018.2739,1018.4141,2022.2739,1014.4141" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="2024.2739" y1="1014.4141" y2="1014.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.9199" x="957.8516" y="1009.3481">upsert cart + item</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg30"><polygon fill="#181818" points="2359.0854,1039.5469,2369.0854,1043.5469,2359.0854,1047.5469,2363.0854,1043.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="1043.5469" y2="1043.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.1694" x="2037.2739" y="1038.481">INSERT/UPDATE cart, cart_item</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg31"><polygon fill="#181818" points="2041.2739,1068.6797,2031.2739,1072.6797,2041.2739,1076.6797,2037.2739,1072.6797" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="1072.6797" y2="1072.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="1067.6138">ok</text></g><g class="message" data-entity-1="part6" data-entity-2="part4" id="msg32"><polygon fill="#181818" points="602.71,1097.8125,592.71,1101.8125,602.71,1105.8125,598.71,1101.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="949.8516" y1="1101.8125" y2="1101.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.7446" x="608.71" y="1096.7466">cart updated</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg33"><polygon fill="#181818" points="423.7065,1126.9453,413.7065,1130.9453,423.7065,1134.9453,419.7065,1130.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="1130.9453" y2="1130.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.501" x="429.7065" y="1125.8794">200 cart</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg34"><polygon fill="#181818" points="244.7031,1156.0781,234.7031,1160.0781,244.7031,1164.0781,240.7031,1160.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="1160.0781" y2="1160.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25.5557" x="250.7031" y="1155.0122">cart</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg35"><polygon fill="#181818" points="54.5659,1185.2109,44.5659,1189.2109,54.5659,1193.2109,50.5659,1189.2109" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.5659" x2="232.7031" y1="1189.2109" y2="1189.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.6743" x="60.5659" y="1184.145">Cart updated</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2558.8027" x="0" y="1217.7773"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="1217.7773" y2="1217.7773"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="1220.7773" y2="1220.7773"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="329.4722" x="1114.6653" y="1207.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="310.9463" x="1120.6653" y="1223.2778">Create order (reserve stock + hold points)</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg36"><polygon fill="#181818" points="221.7031,1257.4766,231.7031,1261.4766,221.7031,1265.4766,225.7031,1261.4766" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43.5659" x2="227.7031" y1="1261.4766" y2="1261.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.5571" x="50.5659" y="1256.4106">Checkout (place order)</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg37"><polygon fill="#181818" points="400.7065,1286.6094,410.7065,1290.6094,400.7065,1294.6094,404.7065,1290.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="233.7031" x2="406.7065" y1="1290.6094" y2="1290.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4429" x="240.7031" y="1285.5435">POST /orders</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg38"><polygon fill="#181818" points="579.71,1315.7422,589.71,1319.7422,579.71,1323.7422,583.71,1319.7422" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="412.7065" x2="585.71" y1="1319.7422" y2="1319.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.4429" x="419.7065" y="1314.6763">POST /orders</text></g><g class="message" data-entity-1="part4" data-entity-2="part6" id="msg39"><polygon fill="#181818" points="938.8516,1344.875,948.8516,1348.875,938.8516,1352.875,942.8516,1348.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="591.71" x2="944.8516" y1="1348.875" y2="1348.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.646" x="598.71" y="1343.8091">placeOrder(user)</text></g><g class="message" data-entity-1="part6" data-entity-2="part9" id="msg40"><polygon fill="#181818" points="2018.2739,1374.0078,2028.2739,1378.0078,2018.2739,1382.0078,2022.2739,1378.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="2024.2739" y1="1378.0078" y2="1378.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.7476" x="957.8516" y="1372.9419">load cart items</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg41"><polygon fill="#181818" points="2359.0854,1403.1406,2369.0854,1407.1406,2359.0854,1411.1406,2363.0854,1407.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="1407.1406" y2="1407.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.6045" x="2037.2739" y="1402.0747">SELECT cart/cart_items...</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg42"><polygon fill="#181818" points="2041.2739,1432.2734,2031.2739,1436.2734,2041.2739,1440.2734,2037.2739,1436.2734" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="1436.2734" y2="1436.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.3916" x="2047.2739" y="1431.2075">cart rows</text></g><g class="message" data-entity-1="part9" data-entity-2="part6" id="msg43"><polygon fill="#181818" points="961.8516,1461.4063,951.8516,1465.4063,961.8516,1469.4063,957.8516,1465.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="2029.2739" y1="1465.4063" y2="1465.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.8315" x="967.8516" y="1460.3403">cart items</text></g><g class="message" data-entity-1="part6" data-entity-2="part7" id="msg44"><polygon fill="#181818" points="1169.7471,1490.5391,1179.7471,1494.5391,1169.7471,1498.5391,1173.7471,1494.5391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="1175.7471" y1="1494.5391" y2="1494.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.4155" x="957.8516" y="1489.4731">reserveStock(items)</text></g><g class="message" data-entity-1="part7" data-entity-2="part9" id="msg45"><polygon fill="#181818" points="2018.2739,1519.6719,2028.2739,1523.6719,2018.2739,1527.6719,2022.2739,1523.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1181.7471" x2="2024.2739" y1="1523.6719" y2="1523.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.9922" x="1188.7471" y="1518.606">SELECT stock FOR UPDATE</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg46"><polygon fill="#181818" points="2359.0854,1548.8047,2369.0854,1552.8047,2359.0854,1556.8047,2363.0854,1552.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="1552.8047" y2="1552.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.3892" x="2037.2739" y="1547.7388">SELECT stock FOR UPDATE...</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg47"><polygon fill="#181818" points="2041.2739,1577.9375,2031.2739,1581.9375,2041.2739,1585.9375,2037.2739,1581.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="1581.9375" y2="1581.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.3354" x="2047.2739" y="1576.8716">stock rows</text></g><g class="message" data-entity-1="part9" data-entity-2="part7" id="msg48"><polygon fill="#181818" points="1192.7471,1607.0703,1182.7471,1611.0703,1192.7471,1615.0703,1188.7471,1611.0703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="1186.7471" x2="2029.2739" y1="1611.0703" y2="1611.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.4995" x="1198.7471" y="1606.0044">stock</text></g><path d="M10,1626.0703 L74.4429,1626.0703 L74.4429,1633.2031 L64.4429,1643.2031 L10,1643.2031 L10,1626.0703" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="294.1328" style="stroke:#000000;stroke-width:1.5;" width="2414.4619" x="10" y="1626.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="1639.1372">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="117.5679" x="89.4429" y="1638.2808">[Insufficient stock]</text><g class="message" data-entity-1="part7" data-entity-2="part6" id="msg49"><polygon fill="#181818" points="961.8516,1660.3359,951.8516,1664.3359,961.8516,1668.3359,957.8516,1664.3359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="1180.7471" y1="1664.3359" y2="1664.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.0181" x="967.8516" y="1659.27">fail (not enough stock)</text></g><g class="message" data-entity-1="part6" data-entity-2="part4" id="msg50"><polygon fill="#181818" points="602.71,1689.4688,592.71,1693.4688,602.71,1697.4688,598.71,1693.4688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="949.8516" y1="1693.4688" y2="1693.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.4063" x="608.71" y="1688.4028">409 Not enough stock</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg51"><polygon fill="#181818" points="423.7065,1718.6016,413.7065,1722.6016,423.7065,1726.6016,419.7065,1722.6016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="1722.6016" y2="1722.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.4063" x="429.7065" y="1717.5356">409 Not enough stock</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg52"><polygon fill="#181818" points="244.7031,1747.7344,234.7031,1751.7344,244.7031,1755.7344,240.7031,1751.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="1751.7344" y2="1751.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.9858" x="250.7031" y="1746.6685">error</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg53"><polygon fill="#181818" points="54.5659,1776.8672,44.5659,1780.8672,54.5659,1784.8672,50.5659,1780.8672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.5659" x2="232.7031" y1="1780.8672" y2="1780.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.1953" x="60.5659" y="1775.8013">Show error</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="2424.4619" y1="1789.8672" y2="1789.8672"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="66.333" x="15" y="1800.0776">[Stock OK]</text><g class="message" data-entity-1="part7" data-entity-2="part9" id="msg54"><polygon fill="#181818" points="2018.2739,1820.8047,2028.2739,1824.8047,2018.2739,1828.8047,2022.2739,1824.8047" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1181.7471" x2="2024.2739" y1="1824.8047" y2="1824.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.5566" x="1188.7471" y="1819.7388">INSERT reservations; UPDATE stock.reserved_qty</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg55"><polygon fill="#181818" points="2359.0854,1849.9375,2369.0854,1853.9375,2359.0854,1857.9375,2363.0854,1853.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="1853.9375" y2="1853.9375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.48" x="2037.2739" y="1848.8716">INSERT reservations; UPDATE stock</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg56"><polygon fill="#181818" points="2041.2739,1879.0703,2031.2739,1883.0703,2041.2739,1887.0703,2037.2739,1883.0703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="1883.0703" y2="1883.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="1878.0044">ok</text></g><g class="message" data-entity-1="part7" data-entity-2="part6" id="msg57"><polygon fill="#181818" points="961.8516,1908.2031,951.8516,1912.2031,961.8516,1916.2031,957.8516,1912.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="1180.7471" y1="1912.2031" y2="1912.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.4019" x="967.8516" y="1907.1372">reserved</text></g><g class="message" data-entity-1="part6" data-entity-2="part8" id="msg58"><polygon fill="#181818" points="1344.3755,1944.3359,1354.3755,1948.3359,1344.3755,1952.3359,1348.3755,1948.3359" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="1350.3755" y1="1948.3359" y2="1948.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.4868" x="957.8516" y="1943.27">holdPoints(user, total_points)</text></g><g class="message" data-entity-1="part8" data-entity-2="part9" id="msg59"><polygon fill="#181818" points="2018.2739,1973.4688,2028.2739,1977.4688,2018.2739,1981.4688,2022.2739,1977.4688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1356.3755" x2="2024.2739" y1="1977.4688" y2="1977.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.8477" x="1363.3755" y="1972.4028">SELECT user FOR UPDATE</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg60"><polygon fill="#181818" points="2359.0854,2002.6016,2369.0854,2006.6016,2359.0854,2010.6016,2363.0854,2006.6016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="2006.6016" y2="2006.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.2446" x="2037.2739" y="2001.5356">SELECT user FOR UPDATE...</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg61"><polygon fill="#181818" points="2041.2739,2031.7344,2031.2739,2035.7344,2041.2739,2039.7344,2037.2739,2035.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="2035.7344" y2="2035.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.418" x="2047.2739" y="2030.6685">user row</text></g><path d="M10,2050.7344 L74.4429,2050.7344 L74.4429,2057.8672 L64.4429,2067.8672 L10,2067.8672 L10,2050.7344" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="410.6641" style="stroke:#000000;stroke-width:1.5;" width="2414.4619" x="10" y="2050.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="2063.8013">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="325.4023" x="89.4429" y="2062.9448">[Insufficient points (available = balance - reserved)]</text><g class="message" data-entity-1="part8" data-entity-2="part6" id="msg62"><polygon fill="#181818" points="961.8516,2085,951.8516,2089,961.8516,2093,957.8516,2089" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="1355.3755" y1="2089" y2="2089"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.4453" x="967.8516" y="2083.9341">fail (not enough points)</text></g><g class="message" data-entity-1="part6" data-entity-2="part7" id="msg63"><polygon fill="#181818" points="1169.7471,2114.1328,1179.7471,2118.1328,1169.7471,2122.1328,1173.7471,2118.1328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="1175.7471" y1="2118.1328" y2="2118.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.293" x="957.8516" y="2113.0669">releaseStockReservations()</text></g><g class="message" data-entity-1="part7" data-entity-2="part9" id="msg64"><polygon fill="#181818" points="2018.2739,2143.2656,2028.2739,2147.2656,2018.2739,2151.2656,2022.2739,2147.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1181.7471" x2="2024.2739" y1="2147.2656" y2="2147.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="404.936" x="1188.7471" y="2142.1997">UPDATE reservations=RELEASED; UPDATE stock.reserved_qty</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg65"><polygon fill="#181818" points="2359.0854,2172.3984,2369.0854,2176.3984,2359.0854,2180.3984,2363.0854,2176.3984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="2176.3984" y2="2176.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.8945" x="2037.2739" y="2171.3325">UPDATE reservations; UPDATE stock</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg66"><polygon fill="#181818" points="2041.2739,2201.5313,2031.2739,2205.5313,2041.2739,2209.5313,2037.2739,2205.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="2205.5313" y2="2205.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="2200.4653">ok</text></g><g class="message" data-entity-1="part6" data-entity-2="part4" id="msg67"><polygon fill="#181818" points="602.71,2230.6641,592.71,2234.6641,602.71,2238.6641,598.71,2234.6641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="949.8516" y1="2234.6641" y2="2234.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.8335" x="608.71" y="2229.5981">409 Not enough points</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg68"><polygon fill="#181818" points="423.7065,2259.7969,413.7065,2263.7969,423.7065,2267.7969,419.7065,2263.7969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="2263.7969" y2="2263.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.8335" x="429.7065" y="2258.731">409 Not enough points</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg69"><polygon fill="#181818" points="244.7031,2288.9297,234.7031,2292.9297,244.7031,2296.9297,240.7031,2292.9297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="2292.9297" y2="2292.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.9858" x="250.7031" y="2287.8638">error</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg70"><polygon fill="#181818" points="54.5659,2318.0625,44.5659,2322.0625,54.5659,2326.0625,50.5659,2322.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.5659" x2="232.7031" y1="2322.0625" y2="2322.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.1953" x="60.5659" y="2316.9966">Show error</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="2424.4619" y1="2331.0625" y2="2331.0625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="70.7856" x="15" y="2341.2729">[Points OK]</text><g class="message" data-entity-1="part8" data-entity-2="part9" id="msg71"><polygon fill="#181818" points="2018.2739,2362,2028.2739,2366,2018.2739,2370,2022.2739,2366" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1356.3755" x2="2024.2739" y1="2366" y2="2366"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="382.2368" x="1363.3755" y="2360.9341">UPDATE user.points_reserved; INSERT ledger_entry(HOLD)</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg72"><polygon fill="#181818" points="2359.0854,2391.1328,2369.0854,2395.1328,2359.0854,2399.1328,2363.0854,2395.1328" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="2395.1328" y2="2395.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.8716" x="2037.2739" y="2390.0669">UPDATE user; INSERT ledger_entry</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg73"><polygon fill="#181818" points="2041.2739,2420.2656,2031.2739,2424.2656,2041.2739,2428.2656,2037.2739,2424.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="2424.2656" y2="2424.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="2419.1997">ok</text></g><g class="message" data-entity-1="part8" data-entity-2="part6" id="msg74"><polygon fill="#181818" points="961.8516,2449.3984,951.8516,2453.3984,961.8516,2457.3984,957.8516,2453.3984" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="1355.3755" y1="2453.3984" y2="2453.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28.1011" x="967.8516" y="2448.3325">held</text></g><g class="message" data-entity-1="part6" data-entity-2="part9" id="msg75"><polygon fill="#181818" points="2018.2739,2485.5313,2028.2739,2489.5313,2018.2739,2493.5313,2022.2739,2489.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="2024.2739" y1="2489.5313" y2="2489.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.2085" x="957.8516" y="2484.4653">INSERT order/order_items; clear cart</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg76"><polygon fill="#181818" points="2359.0854,2514.6641,2369.0854,2518.6641,2359.0854,2522.6641,2363.0854,2518.6641" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="2518.6641" y2="2518.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.6191" x="2037.2739" y="2513.5981">INSERT order/order_items; DELETE cart_items</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg77"><polygon fill="#181818" points="2041.2739,2543.7969,2031.2739,2547.7969,2041.2739,2551.7969,2037.2739,2547.7969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="2547.7969" y2="2547.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="2542.731">ok</text></g><g class="message" data-entity-1="part6" data-entity-2="part4" id="msg78"><polygon fill="#181818" points="602.71,2572.9297,592.71,2576.9297,602.71,2580.9297,598.71,2576.9297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="949.8516" y1="2576.9297" y2="2576.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.0532" x="608.71" y="2571.8638">201 Order created</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg79"><polygon fill="#181818" points="423.7065,2602.0625,413.7065,2606.0625,423.7065,2610.0625,419.7065,2606.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="2606.0625" y2="2606.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.8384" x="429.7065" y="2600.9966">201 order</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg80"><polygon fill="#181818" points="244.7031,2631.1953,234.7031,2635.1953,244.7031,2639.1953,240.7031,2635.1953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="2635.1953" y2="2635.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8291" x="250.7031" y="2630.1294">order created</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg81"><polygon fill="#181818" points="54.5659,2660.3281,44.5659,2664.3281,54.5659,2668.3281,50.5659,2664.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="48.5659" x2="232.7031" y1="2664.3281" y2="2664.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.6147" x="60.5659" y="2659.2622">Show confirmation</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2558.8027" x="0" y="2692.8945"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="2692.8945" y2="2692.8945"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2558.8027" y1="2695.8945" y2="2695.8945"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="386.582" x="1086.1104" y="2682.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="368.0562" x="1092.1104" y="2698.395">Issue order (consume reservation + spend points)</text><g class="message" data-entity-1="part11" data-entity-2="part2" id="msg82"><polygon fill="#181818" points="244.7031,2732.5938,234.7031,2736.5938,244.7031,2740.5938,240.7031,2736.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="238.7031" x2="2488.1323" y1="2736.5938" y2="2736.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.6646" x="250.7031" y="2731.5278">Select order for issue</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg83"><polygon fill="#181818" points="400.7065,2761.7266,410.7065,2765.7266,400.7065,2769.7266,404.7065,2765.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="233.7031" x2="406.7065" y1="2765.7266" y2="2765.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.0034" x="240.7031" y="2760.6606">POST /orders/{id}/issue</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg84"><polygon fill="#181818" points="579.71,2790.8594,589.71,2794.8594,579.71,2798.8594,583.71,2794.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="412.7065" x2="585.71" y1="2794.8594" y2="2794.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.0034" x="419.7065" y="2789.7935">POST /orders/{id}/issue</text></g><g class="message" data-entity-1="part4" data-entity-2="part6" id="msg85"><polygon fill="#181818" points="938.8516,2819.9922,948.8516,2823.9922,938.8516,2827.9922,942.8516,2823.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="591.71" x2="944.8516" y1="2823.9922" y2="2823.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.9673" x="598.71" y="2818.9263">issueOrder(order_id)</text></g><g class="message" data-entity-1="part6" data-entity-2="part7" id="msg86"><polygon fill="#181818" points="1169.7471,2849.125,1179.7471,2853.125,1169.7471,2857.125,1173.7471,2853.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="1175.7471" y1="2853.125" y2="2853.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.8955" x="957.8516" y="2848.0591">consumeReservations(order_id)</text></g><g class="message" data-entity-1="part7" data-entity-2="part9" id="msg87"><polygon fill="#181818" points="2018.2739,2878.2578,2028.2739,2882.2578,2018.2739,2886.2578,2022.2739,2882.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1181.7471" x2="2024.2739" y1="2882.2578" y2="2882.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391.9106" x="1188.7471" y="2877.1919">UPDATE reservations=CONSUMED; UPDATE stock (available</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" text-decoration="line-through" textLength="65.6665" x="1580.6577" y="2877.1919">, reserved</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="1646.3242" y="2877.1919">)</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg88"><polygon fill="#181818" points="2359.0854,2907.3906,2369.0854,2911.3906,2359.0854,2915.3906,2363.0854,2911.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="2911.3906" y2="2911.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.8945" x="2037.2739" y="2906.3247">UPDATE reservations; UPDATE stock</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg89"><polygon fill="#181818" points="2041.2739,2936.5234,2031.2739,2940.5234,2041.2739,2944.5234,2037.2739,2940.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="2940.5234" y2="2940.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="2935.4575">ok</text></g><g class="message" data-entity-1="part7" data-entity-2="part6" id="msg90"><polygon fill="#181818" points="961.8516,2965.6563,951.8516,2969.6563,961.8516,2973.6563,957.8516,2969.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="1180.7471" y1="2969.6563" y2="2969.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="967.8516" y="2964.5903">ok</text></g><g class="message" data-entity-1="part6" data-entity-2="part8" id="msg91"><polygon fill="#181818" points="1344.3755,2994.7891,1354.3755,2998.7891,1344.3755,3002.7891,1348.3755,2998.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="1350.3755" y1="2998.7891" y2="2998.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0659" x="957.8516" y="2993.7231">spendHeldPoints(order_id)</text></g><g class="message" data-entity-1="part8" data-entity-2="part9" id="msg92"><polygon fill="#181818" points="2018.2739,3023.9219,2028.2739,3027.9219,2018.2739,3031.9219,2022.2739,3027.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1356.3755" x2="2024.2739" y1="3027.9219" y2="3027.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="649.8984" x="1363.3755" y="3022.856">SELECT user FOR UPDATE; UPDATE points_balance &amp; points_reserved; INSERT ledger_entry(SPEND)</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg93"><polygon fill="#181818" points="2359.0854,3053.0547,2369.0854,3057.0547,2359.0854,3061.0547,2363.0854,3057.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="3057.0547" y2="3057.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.8115" x="2037.2739" y="3051.9888">SELECT user; UPDATE user; INSERT ledger_entry</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg94"><polygon fill="#181818" points="2041.2739,3082.1875,2031.2739,3086.1875,2041.2739,3090.1875,2037.2739,3086.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="3086.1875" y2="3086.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="3081.1216">ok</text></g><g class="message" data-entity-1="part8" data-entity-2="part6" id="msg95"><polygon fill="#181818" points="961.8516,3111.3203,951.8516,3115.3203,961.8516,3119.3203,957.8516,3115.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="955.8516" x2="1355.3755" y1="3115.3203" y2="3115.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="967.8516" y="3110.2544">ok</text></g><g class="message" data-entity-1="part6" data-entity-2="part9" id="msg96"><polygon fill="#181818" points="2018.2739,3140.4531,2028.2739,3144.4531,2018.2739,3148.4531,2022.2739,3144.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="950.8516" x2="2024.2739" y1="3144.4531" y2="3144.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.4858" x="957.8516" y="3139.3872">UPDATE order status=ISSUED</text></g><g class="message" data-entity-1="part9" data-entity-2="part10" id="msg97"><polygon fill="#181818" points="2359.0854,3169.5859,2369.0854,3173.5859,2359.0854,3177.5859,2363.0854,3173.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="2030.2739" x2="2365.0854" y1="3173.5859" y2="3173.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.438" x="2037.2739" y="3168.52">UPDATE order</text></g><g class="message" data-entity-1="part10" data-entity-2="part9" id="msg98"><polygon fill="#181818" points="2041.2739,3198.7188,2031.2739,3202.7188,2041.2739,3206.7188,2037.2739,3202.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="2035.2739" x2="2370.0854" y1="3202.7188" y2="3202.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="15.4819" x="2047.2739" y="3197.6528">ok</text></g><g class="message" data-entity-1="part6" data-entity-2="part4" id="msg99"><polygon fill="#181818" points="602.71,3227.8516,592.71,3231.8516,602.71,3235.8516,598.71,3231.8516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="596.71" x2="949.8516" y1="3231.8516" y2="3231.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.8145" x="608.71" y="3226.7856">200 Issued</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg100"><polygon fill="#181818" points="423.7065,3256.9844,413.7065,3260.9844,423.7065,3264.9844,419.7065,3260.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="417.7065" x2="590.71" y1="3260.9844" y2="3260.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.8145" x="429.7065" y="3255.9185">200 Issued</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg101"><polygon fill="#181818" points="244.7031,3286.1172,234.7031,3290.1172,244.7031,3294.1172,240.7031,3290.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="238.7031" x2="411.7065" y1="3290.1172" y2="3290.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.8511" x="250.7031" y="3285.0513">success</text></g><g class="message" data-entity-1="part2" data-entity-2="part11" id="msg102"><polygon fill="#181818" points="2477.1323,3315.25,2487.1323,3319.25,2477.1323,3323.25,2481.1323,3319.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="233.7031" x2="2483.1323" y1="3319.25" y2="3319.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.9512" x="240.7031" y="3314.1841">Order issued</text></g><?plantuml-src fLVBRkCs5DthAovcKKX872T15wq35_1hEa7Js8qIT1am4cqBaKMDI6KcAFhllNn8eHnITZeRGI8FUH_dliIViw8a5Td1YbGYIxAI5695qZGhDd3nIy3R_IdxtgvV1W591AjWMh_I2WZNBq7vTWTy-fi-mQGiFybjVCVNxlvaTGspFAE5K919cUcle0kRakIP5Yb8U5YnMj2AH-h4dVxemcT4a9njOCVIEgSAPvQwk6MLubaRfbUwgElY1JLYrQiDR1Uxs1kQRj0P5b2lT54hb95nGOk4mWsHtWlZlsucURAbkrTjbmK9KjJzYN2A1naNcueYM87cqo0OZs5QiM-ucnYhXr1MA3yHC1u7cfp1RyRx8rYMj6YWWLwKswtdH_3xuXw6vWeUj1iIPRozZp7B4c7yF88SjLyPG1W53IK8iKmRmTUQecFRcspF87G-7K6yk5dCxbl8sTbPC9_2OFyYwOFkSLkRLa2hXstDUqEw7hayFmUNGootjjkDIt5F-HuDsB9lhSSzX3IC9QHAZs1b-4-M_diCDHheucT36th2B3sIdvCTJJDomWLBdWzJDLJeeKB_46kGKa6ol9-y5dIOmtuAVGnsA99fDqbJ44n-kpFDtW_DwLFuAbuZDyEhPOpCIVWm4tJdIxrtC8jTNRv6W3NwdiqG4jQSLgVGbMxAtZuNTObOeVKz0NctY-FhstXnTpzyMCqdzmi5FbNFHtN0nJ5xRYNQTYWvTOd5ZQPzf4cSXp6rzPwkcNspP6fMKNm79hN0_a7HpXSAAZ3HqYtBKoXPLWWUEOcSRMdoZ0eYYpb9p3sz93BTHle8D107UKg8-b3iHO6Fi9oHLBjH1u8_8rMqj2nvQwYwovcIZMwMD4khjXbYGcldnjAteG96mLi3tHTerDDCV5xUWGwh7alseJvJDCvfYwMjhcG1oGMkydgznXOjwTBh09RcbXFMM6SWB9W0Mh1wizNm2F6kEF_v_5UutSCYr1Fn7hGx_cbLiGftFHLBRzCSPmF51op_wDgqvpETseP28Z9My2lZPgt8cM4tVSGwWbTvoqFF7NZCKoHyxcw41ZW1sb6d9wkHoj-LIbzJxGJ3Dl5eCZem8vadzEI9uo9l3-aBF0N3k7D4bTO8GlA20KIUSWfZU28vKR9QCsKSDJht1LrZtrlKxILYJd5cLCJVMMo4KMyC6Afi_iPtw819l9X_E1WSbnqV34VaadR1qSdKmdyqctIqwNJoX9UnKaR3cPRxsFZhgacIN1rzH3sgr_3BycOUzRfHtkKys-T5HoHjQVukbrnrG7KetQTqsxY216EgqctNd_kEStEC83CjwAMF30gNvnTQTqXK7--P5YwqSC-um3gN-0PrLgopQgUYLGqFrvpNxUo0kxpUKJkaSOBWfVmvjKO8_MFywNEThxCytqb59kakAzHVcraD0lDYZnenPYtEc5hQ6k_8fFJ3euQQyuSQV7ZgiD6E0KHjw074i9X6ddPl_D4fC6zdFbPcPilR-E7F_J9ZbSl1uBIjaeD15FolYkC9F7VhmGr7mr5qVw5jrtap-4EzfbNCr8Uc5Vm4HnMCUBMudKS76jRLuUBXSOYZS7IzuU9JnoqNHDHyV1t73ujv3qiwLptoFQNWNETZxn-3GRYB0A-JXFBEVxh9mv6fCYhyq_y0?></g></svg>